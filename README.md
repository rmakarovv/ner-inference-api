# NER Inference API

## Общее описание решения

Данный проект представляет собой API для распознавания именованных сущностей (Named Entity Recognition, NER) в русском языке. Используется предобученная модель RuBERT tiny 2, адаптированная на предоставленных тренировочных данных. API позволяет выполнять инференс на входном тексте и возвращает токены с соответствующими метками сущностей.

## Описание технической реализации

### Логика бэкенда

1. **Инициализация приложения**: Используется FastAPI для создания веб-приложения.
2. **Загрузка модели и токенизатора**: При запуске приложения загружается предобученная модель и токенизатор из директории `ner_bert.bin`.
3. **Маршруты**:
   - `GET /inference`: Принимает текст на вход и возвращает токены с соответствующими метками сущностей.
   - `GET /`: Главная страница, доступ к краткому описанию проекта.

### Краткое описание методов

- **inference_single**: Выполняет инференс на входном тексте, возвращая токены и их метки.
- **get_inference**: Обрабатывает запросы на инференс, используя метод `inference_single`, и возвращает результат в формате JSON.

### Описание выборки для обучения

Для обучения модели использовались предоставленные тренировочные данные. Данные были предварительно обработаны и разбиты на тренировочный и тестовый наборы. Модель обучалась на этих данных для распознавания следующих меток:
- O: Не сущность
- B-discount: Начало сущности "скидка"
- B-value: Начало сущности "значение"
- I-value: Внутренняя часть сущности "значение"

## Стек технологий

- **FastAPI**: Веб-фреймворк для создания API.
- **transformers**: Библиотека от Hugging Face для работы с предобученными моделями.
- **torch**: Библиотека для работы с моделями глубокого обучения.
- **pandas**: Библиотека для работы с данными.
- **scikit-learn**: Библиотека для машинного обучения (метрики и разбиение данных).
- **seqeval**: Библиотека для оценки последовательных моделей.

## Инструкция по установке и развертыванию

### Шаг 1: Клонирование репозитория

```sh
git clone https://github.com/rmakarovv/ner-inference-api.git
cd ner-inference-api
```

Отдельно скачайте файл `model.safetensors` из релиза `Weights` и поместите его в папку `ner_bert.bin`

### Шаг 2: Установка зависимостей

Установите все необходимые зависимости:

```sh
pip install -r requirements.txt
```

### Шаг 3: Запуск приложения

Запустите решение:

```sh
python3 app.py
```

### Шаг 4: Использование API

Откройте веб-браузер и перейдите по адресу `http://localhost:8000/`.

Для выполнения инференса используйте маршрут `GET /inference` и передайте текст для анализа.

### Пример запроса с использованием Python: 

```python
import requests

url = "http://0.0.0.0:8000/inference"
data = {"text": "Скидка предоставляется 20 процентов"}

response = requests.get(url, json=data)
print(response.json())
```

Ответ будет содержать токены и их метки в формате JSON.

### Пример ответа:

```json
{
  "tokens": ["Скидка", "предоставляется", "20", "процентов"],
  "labels": ["B-discount", "O", "B-value", "I-value"]
}
```